---
title: "Reproducible Research: Peer Assessment 1"
author: jkim19
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data
Does this save?
(note: activity.csv must be unzipped and in same directory as script to run properly)
(note: this analysis will be using ggplot2 and dplyr and the following also code loads those libraries)
```{r, echo=TRUE}
suppressMessages(library(dplyr))
library(ggplot2)

activitydf <- read.csv("activity.csv", header=TRUE, colClasses=c("numeric","Date","numeric"))
summary(activitydf)
dim(activitydf)
```

## What is mean total number of steps taken per day?
```{r, echo=TRUE}
stepsbyday <- group_by(select(activitydf,date,steps),date)
totalsbyday <- summarise_each(stepsbyday,funs(sum))
tbdplot <- qplot(date,steps,data=totalsbyday,geom="bar",stat="identity")
tbdplot <- tbdplot + ggtitle("Total Steps Per Day") + xlab("Date") + ylab("Total Steps")
yabline <- mean(totalsbyday$steps,na.rm=TRUE)
tbdplot <- tbdplot + geom_abline(intercept=yabline,slope=0,colour="red")
tbdplot
#mean
yabline
#median
median(totalsbyday$steps,na.rm=TRUE)

meansbyday <- summarise_each(stepsbyday,funs(mean))
mediansbyday <- summarise_each(stepsbyday,funs(median))
mean(meansbyday$steps,na.rm=TRUE)
median(meansbyday$steps,na.rm=TRUE)
```

## What is the average daily activity pattern?
```{r, echo=TRUE}
stepsbyint <- group_by(select(activitydf,interval,steps),interval)
meanstepsbyint <- summarise_each(stepsbyint,funs(mean(.,na.rm=TRUE)))

msbiplot <- qplot(interval,steps,data=meanstepsbyint,geom="line")
msbiplot <- msbiplot + ggtitle("Average Steps Per 5-minute Interval") + xlab("5-minute Interval Throughout Day") + ylab("Average Steps")
msbiplot

orderedbyint <- arrange(meanstepsbyint,desc(steps))
#highest average steps occur during this 5-minute interval
orderedbyint[1,]
```

## Imputing missing values
```{r, echo=TRUE}
sum(is.na(activitydf$steps))
```
Let's enter the average steps for that particular five minute interval in the missing interval
```{r, echo=TRUE}
copydf <- activitydf
avgspi <- sapply(copydf$interval,function(x) filter(meanstepsbyint,interval==x)$steps)
copydf <- cbind(copydf,avgspi)
copydf <- mutate(copydf, modsteps= ifelse(is.na(steps),avgspi,steps))
```
Now, let's chart the total steps per day with filled in data.  And let's examine the mean and median
```{r, echo=TRUE}
stepsbyday2 <- group_by(select(copydf,date,modsteps),date)
totalsbyday2 <- summarise_each(stepsbyday2,funs(sum))
tbdplot2 <- qplot(date,modsteps,data=totalsbyday2,geom="bar",stat="identity")
tbdplot2 <- tbdplot2 + ggtitle("Total Steps Per Day (Filled in Missing Data)") + xlab("Date") + ylab("Total Steps")
yabline2 <- mean(totalsbyday2$modsteps,na.rm=TRUE)
tbdplot2 <- tbdplot2 + geom_abline(intercept=yabline2,slope=0,colour="red")
tbdplot2
#mean
yabline2
#median
median(totalsbyday2$modsteps,na.rm=TRUE)
```
It appears that since we filled in the missing data with averages, the actual means stayed the same, but the medians actually moved towards the mean.


## Are there differences in activity patterns between weekdays and weekends?
